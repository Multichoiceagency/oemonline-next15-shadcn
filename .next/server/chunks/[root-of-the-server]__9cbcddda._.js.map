{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/lib/env.ts"],"sourcesContent":["export function req(name: string, fallback?: string) {\r\nconst v = process.env[name] ?? fallback\r\nif (!v) throw new Error(`Missing env: ${name}`)\r\nreturn v\r\n}\r\n\r\n\r\nexport const ENV = {\r\nTECDOC_PROVIDER_ID: req(\"TECDOC_PROVIDER_ID\"),\r\nTECDOC_API_KEY: req(\"TECDOC_API_KEY\"),\r\nTECDOC_LANG_DEFAULT: req(\"TECDOC_LANG_DEFAULT\", \"nl\"),\r\nTECDOC_LANGS: req(\"TECDOC_LANGS\", \"nl,fr\").split(\",\"),\r\nTECDOC_ARTICLE_COUNTRIES: req(\"TECDOC_ARTICLE_COUNTRIES\", \"nl,be,lu\").split(\",\"),\r\nTECDOC_LINKAGE_COUNTRY: req(\"TECDOC_LINKAGE_COUNTRY\", \"nl\"),\r\nTECDOC_BASE_JSON: req(\"TECDOC_BASE_JSON\"),\r\nTECDOC_PLATE_ENABLED: (process.env.TECDOC_PLATE_ENABLED ?? \"true\") === \"true\",\r\nTECDOC_PLATE_COUNTRY: req(\"TECDOC_PLATE_COUNTRY\", \"nl\"),\r\nTECDOC_DOWNLOAD_IMAGES: (process.env.TECDOC_DOWNLOAD_IMAGES ?? \"true\") === \"true\",\r\nTECDOC_DEBUG: (process.env.TECDOC_DEBUG ?? \"true\") === \"true\",\r\n}"],"names":[],"mappings":";;;;;;AAAO,SAAS,IAAI,IAAY,EAAE,QAAiB;IACnD,MAAM,IAAI,QAAQ,GAAG,CAAC,KAAK,IAAI;IAC/B,IAAI,CAAC,GAAG,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE,MAAM;IAC9C,OAAO;AACP;AAGO,MAAM,MAAM;IACnB,oBAAoB,IAAI;IACxB,gBAAgB,IAAI;IACpB,qBAAqB,IAAI,uBAAuB;IAChD,cAAc,IAAI,gBAAgB,SAAS,KAAK,CAAC;IACjD,0BAA0B,IAAI,4BAA4B,YAAY,KAAK,CAAC;IAC5E,wBAAwB,IAAI,0BAA0B;IACtD,kBAAkB,IAAI;IACtB,sBAAsB,CAAC,QAAQ,GAAG,CAAC,oBAAoB,IAAI,MAAM,MAAM;IACvE,sBAAsB,IAAI,wBAAwB;IAClD,wBAAwB,CAAC,QAAQ,GAAG,CAAC,sBAAsB,IAAI,MAAM,MAAM;IAC3E,cAAc,CAAC,QAAQ,GAAG,CAAC,YAAY,IAAI,MAAM,MAAM;AACvD","debugId":null}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/lib/logger.ts"],"sourcesContent":["export function logDebug(label: string, payload: unknown) {\r\ntry { console.log(`[TecDoc] ${label}:`, JSON.stringify(payload)) } catch {}\r\n}\r\nexport function logError(label: string, payload: unknown) {\r\ntry { console.error(`[TecDoc][ERROR] ${label}:`, JSON.stringify(payload)) } catch {}\r\n}"],"names":[],"mappings":";;;;;;AAAO,SAAS,SAAS,KAAa,EAAE,OAAgB;IACxD,IAAI;QAAE,QAAQ,GAAG,CAAC,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC;IAAU,EAAE,OAAM,CAAC;AAC1E;AACO,SAAS,SAAS,KAAa,EAAE,OAAgB;IACxD,IAAI;QAAE,QAAQ,KAAK,CAAC,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC;IAAU,EAAE,OAAM,CAAC;AACnF","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/lib/tecdoc.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { ENV } from \"@/lib/env\";\r\nimport { logDebug, logError } from \"@/lib/logger\";\r\n\r\nexport const TecdocOps = {\r\n  searchTerm: \"articleSearchByTerm\",\r\n  byPlate: \"getVehiclesByKeyNumberPlates\",\r\n  byVin: \"getVehiclesByVIN\",\r\n  byMotorId: \"getVehicleIdsByMotor2\",\r\n  manufacturers: \"getManufacturers\",\r\n  models: \"getModelSeries\",\r\n  types: \"getVehicleIdsByCriteria\",\r\n  genericArticles: \"getGenericArticles\",\r\n  amBrands: \"getAmBrands\",\r\n  articleById: \"getArticleDirectSearchById\",\r\n  articleImages: \"getArticleImages\",\r\n  articleIdsWithState: \"getArticleIdsWithState\",\r\n  assignedArticlesByIds6: \"getAssignedArticlesByIds6\",\r\n} as const;\r\n\r\nexport type TecdocResource =\r\n  | (typeof TecdocOps)[keyof typeof TecdocOps]\r\n  | string;\r\n\r\nexport interface TecdocResponse<T = any> {\r\n  status?: number;\r\n  statusText?: string;\r\n  data?: { array?: T[] } & Record<string, any>;\r\n  [k: string]: any;\r\n}\r\n\r\nexport async function tecdocCall<T = any>(\r\n  resource: TecdocResource,\r\n  params: Record<string, any> = {},\r\n  init?: RequestInit\r\n): Promise<TecdocResponse<T>> {\r\n  const controller = new AbortController();\r\n  const timeout = setTimeout(() => controller.abort(), 15000);\r\n\r\n  // inner payload mirrors browser client examples\r\n  const inner = {\r\n    provider: Number(ENV.TECDOC_PROVIDER_ID),\r\n    // many endpoints require these explicitly:\r\n    lang: ENV.TECDOC_LANG_DEFAULT,\r\n    country: ENV.TECDOC_LINKAGE_COUNTRY,\r\n    countryCode: ENV.TECDOC_LINKAGE_COUNTRY,\r\n    articleCountry: ENV.TECDOC_ARTICLE_COUNTRIES[0],\r\n    ...params,\r\n  };\r\n\r\n  // top-level key = functionName/resource\r\n  const body: Record<string, any> = { [resource]: inner };\r\n\r\n  if (ENV.TECDOC_DEBUG)\r\n    logDebug(\"REQUEST\", { resource, url: ENV.TECDOC_BASE_JSON, body });\r\n\r\n  try {\r\n    const url = `${ENV.TECDOC_BASE_JSON}?api_key=${encodeURIComponent(\r\n      ENV.TECDOC_API_KEY\r\n    )}`;\r\n    const res = await fetch(url, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        \"X-Api-Key\": ENV.TECDOC_API_KEY,\r\n      },\r\n      body: JSON.stringify(body),\r\n      signal: controller.signal,\r\n      ...init,\r\n    });\r\n\r\n    clearTimeout(timeout);\r\n\r\n    const text = await res.text();\r\n    let json: TecdocResponse<T>;\r\n    try {\r\n      json = JSON.parse(text);\r\n    } catch {\r\n      json = { raw: text } as any;\r\n    }\r\n\r\n    if (!res.ok) {\r\n      logError(\"RESPONSE\", {\r\n        status: res.status,\r\n        statusText: res.statusText,\r\n        raw: text.slice(0, 500),\r\n      });\r\n      throw new TecdocHttpError(\r\n        String(resource),\r\n        res.status,\r\n        res.statusText,\r\n        text\r\n      );\r\n    }\r\n\r\n    if (ENV.TECDOC_DEBUG)\r\n      logDebug(\"RESPONSE\", {\r\n        resource,\r\n        status: json?.status,\r\n        statusText: json?.statusText,\r\n        dataLen: json?.data?.array?.length,\r\n      });\r\n\r\n    return json;\r\n  } catch (err: any) {\r\n    if (err?.name === \"AbortError\") {\r\n      logError(\"TIMEOUT\", { resource });\r\n      throw new TecdocHttpError(\r\n        String(resource),\r\n        504,\r\n        \"Timeout\",\r\n        \"Request timed out\"\r\n      );\r\n    }\r\n    logError(\"FETCH_ERROR\", { resource, message: String(err?.message || err) });\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport class TecdocHttpError extends Error {\r\n  constructor(\r\n    public resource: string,\r\n    public status: number,\r\n    public statusText: string,\r\n    public rawBody?: string\r\n  ) {\r\n    super(`TecDoc ${resource} ${status}: ${statusText}`);\r\n  }\r\n}\r\n\r\nexport function qp(req: Request, key: string, dflt?: string) {\r\n  const url = new URL(req.url);\r\n  return (url.searchParams.get(key) ?? dflt)?.trim();\r\n}\r\nexport function qpn(req: Request, key: string, dflt?: number) {\r\n  const v = qp(req, key);\r\n  if (!v) return dflt;\r\n  const n = Number(v);\r\n  return Number.isFinite(n) ? n : dflt;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/app/api/plates/route.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\n// app/api/plates/route.ts\r\nimport { NextResponse } from \"next/server\"\r\nimport { tecdocCall, qp } from \"@/lib/tecdoc\"\r\nimport { ENV } from \"@/lib/env\"\r\nimport { logError, logDebug } from \"@/lib/logger\"\r\n\r\nexport const dynamic = \"force-dynamic\"\r\n\r\n// mapping obv. TecDoc VRM-tabel in de Onboarding Guide\r\nconst KEY_SYSTEM_TYPE_BY_COUNTRY: Record<string, number> = {\r\n  nl: 1, // Netherlands VRM\r\n  gb: 99, ie: 99, es: 99, mt: 99, // VRM 99\r\n  au: 75, nz: 75, // VRM 75\r\n  is: 10, // Iceland\r\n  at: 6, ch: 4, de: 20, // AT National code / CH Type permit / DE KBA\r\n  dk: 95, fi: 95, no: 95, se: 95, // VRM 95\r\n  fr: 50, it: 50, pt: 50, // VRM 50\r\n  // alternatieven die soms per tenant gebruikt worden:\r\n  fr_2: 2, fr_21: 21, it_51: 51, dk_55: 55, dk_92: 92,\r\n}\r\n\r\nfunction cleanupPlate(s: string) {\r\n  return s.replace(/[^A-Za-z0-9]/g, \"\").toUpperCase()\r\n}\r\n\r\nexport async function GET(req: Request) {\r\n  if (!ENV.TECDOC_PLATE_ENABLED) {\r\n    return NextResponse.json({ error: \"Plate lookup disabled\" }, { status: 403 })\r\n  }\r\n\r\n  const rawPlate = qp(req, \"plate\")\r\n  if (!rawPlate) return NextResponse.json({ error: \"Missing plate\" }, { status: 400 })\r\n\r\n  const country = (qp(req, \"country\", ENV.TECDOC_PLATE_COUNTRY) || \"nl\").toLowerCase()\r\n  const keySystemType = KEY_SYSTEM_TYPE_BY_COUNTRY[country] ?? 1\r\n  const keySystemNumber = cleanupPlate(rawPlate)\r\n\r\n  if (keySystemNumber.length < 2) {\r\n    return NextResponse.json({ error: \"Kenteken te kort/ongeldig.\" }, { status: 400 })\r\n  }\r\n\r\n  logDebug(\"PLATES_INPUT\", { country, keySystemType, keySystemNumber })\r\n\r\n  try {\r\n    const data = await tecdocCall(\"getVehiclesByKeyNumberPlates\", {\r\n      keySystemType,\r\n      keySystemNumber,\r\n      // vaak prettig om land/taal expliciet mee te geven:\r\n      country,\r\n      countryCode: country,\r\n    })\r\n\r\n    // TecDoc zet status/statusText in de body (ook bij HTTP 200)\r\n    if (data?.status && data.status >= 300) {\r\n      logError(\"PLATES_STATUS\", { status: data.status, statusText: data.statusText })\r\n      return NextResponse.json({ error: data.statusText || \"TecDoc error\", tecdoc: data }, { status: 502 })\r\n    }\r\n\r\n    return NextResponse.json(data, { headers: { \"Cache-Control\": \"private, max-age=300\" } })\r\n  } catch (e: any) {\r\n    logError(\"PLATES_EXCEPTION\", { message: String(e?.message || e) })\r\n    return NextResponse.json({ error: String(e?.message || e) }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,qDAAqD,GACrD,0BAA0B;;;;;;;AAC1B;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAEvB,uDAAuD;AACvD,MAAM,6BAAqD;IACzD,IAAI;IACJ,IAAI;IAAI,IAAI;IAAI,IAAI;IAAI,IAAI;IAC5B,IAAI;IAAI,IAAI;IACZ,IAAI;IACJ,IAAI;IAAG,IAAI;IAAG,IAAI;IAClB,IAAI;IAAI,IAAI;IAAI,IAAI;IAAI,IAAI;IAC5B,IAAI;IAAI,IAAI;IAAI,IAAI;IACpB,qDAAqD;IACrD,MAAM;IAAG,OAAO;IAAI,OAAO;IAAI,OAAO;IAAI,OAAO;AACnD;AAEA,SAAS,aAAa,CAAS;IAC7B,OAAO,EAAE,OAAO,CAAC,iBAAiB,IAAI,WAAW;AACnD;AAEO,eAAe,IAAI,GAAY;IACpC,IAAI,CAAC,iKAAG,CAAC,oBAAoB,EAAE;QAC7B,OAAO,6TAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC7E;IAEA,MAAM,WAAW,IAAA,mKAAE,EAAC,KAAK;IACzB,IAAI,CAAC,UAAU,OAAO,6TAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAgB,GAAG;QAAE,QAAQ;IAAI;IAElF,MAAM,UAAU,CAAC,IAAA,mKAAE,EAAC,KAAK,WAAW,iKAAG,CAAC,oBAAoB,KAAK,IAAI,EAAE,WAAW;IAClF,MAAM,gBAAgB,0BAA0B,CAAC,QAAQ,IAAI;IAC7D,MAAM,kBAAkB,aAAa;IAErC,IAAI,gBAAgB,MAAM,GAAG,GAAG;QAC9B,OAAO,6TAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IAClF;IAEA,IAAA,yKAAQ,EAAC,gBAAgB;QAAE;QAAS;QAAe;IAAgB;IAEnE,IAAI;QACF,MAAM,OAAO,MAAM,IAAA,2KAAU,EAAC,gCAAgC;YAC5D;YACA;YACA,oDAAoD;YACpD;YACA,aAAa;QACf;QAEA,6DAA6D;QAC7D,IAAI,MAAM,UAAU,KAAK,MAAM,IAAI,KAAK;YACtC,IAAA,yKAAQ,EAAC,iBAAiB;gBAAE,QAAQ,KAAK,MAAM;gBAAE,YAAY,KAAK,UAAU;YAAC;YAC7E,OAAO,6TAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,KAAK,UAAU,IAAI;gBAAgB,QAAQ;YAAK,GAAG;gBAAE,QAAQ;YAAI;QACrG;QAEA,OAAO,6TAAY,CAAC,IAAI,CAAC,MAAM;YAAE,SAAS;gBAAE,iBAAiB;YAAuB;QAAE;IACxF,EAAE,OAAO,GAAQ;QACf,IAAA,yKAAQ,EAAC,oBAAoB;YAAE,SAAS,OAAO,GAAG,WAAW;QAAG;QAChE,OAAO,6TAAY,CAAC,IAAI,CAAC;YAAE,OAAO,OAAO,GAAG,WAAW;QAAG,GAAG;YAAE,QAAQ;QAAI;IAC7E;AACF","debugId":null}}]
}