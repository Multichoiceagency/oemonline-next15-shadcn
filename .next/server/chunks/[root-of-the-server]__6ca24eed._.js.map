{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/lib/env.ts"],"sourcesContent":["export function req(name: string, fallback?: string) {\r\nconst v = process.env[name] ?? fallback\r\nif (!v) throw new Error(`Missing env: ${name}`)\r\nreturn v\r\n}\r\n\r\n\r\nexport const ENV = {\r\nTECDOC_PROVIDER_ID: req(\"TECDOC_PROVIDER_ID\"),\r\nTECDOC_API_KEY: req(\"TECDOC_API_KEY\"),\r\nTECDOC_LANG_DEFAULT: req(\"TECDOC_LANG_DEFAULT\", \"nl\"),\r\nTECDOC_LANGS: req(\"TECDOC_LANGS\", \"nl,fr\").split(\",\"),\r\nTECDOC_ARTICLE_COUNTRIES: req(\"TECDOC_ARTICLE_COUNTRIES\", \"nl,be,lu\").split(\",\"),\r\nTECDOC_LINKAGE_COUNTRY: req(\"TECDOC_LINKAGE_COUNTRY\", \"nl\"),\r\nTECDOC_BASE_JSON: req(\"TECDOC_BASE_JSON\"),\r\nTECDOC_PLATE_ENABLED: (process.env.TECDOC_PLATE_ENABLED ?? \"true\") === \"true\",\r\nTECDOC_PLATE_COUNTRY: req(\"TECDOC_PLATE_COUNTRY\", \"nl\"),\r\nTECDOC_DOWNLOAD_IMAGES: (process.env.TECDOC_DOWNLOAD_IMAGES ?? \"true\") === \"true\",\r\nTECDOC_DEBUG: (process.env.TECDOC_DEBUG ?? \"true\") === \"true\",\r\n}"],"names":[],"mappings":";;;;;;AAAO,SAAS,IAAI,IAAY,EAAE,QAAiB;IACnD,MAAM,IAAI,QAAQ,GAAG,CAAC,KAAK,IAAI;IAC/B,IAAI,CAAC,GAAG,MAAM,IAAI,MAAM,CAAC,aAAa,EAAE,MAAM;IAC9C,OAAO;AACP;AAGO,MAAM,MAAM;IACnB,oBAAoB,IAAI;IACxB,gBAAgB,IAAI;IACpB,qBAAqB,IAAI,uBAAuB;IAChD,cAAc,IAAI,gBAAgB,SAAS,KAAK,CAAC;IACjD,0BAA0B,IAAI,4BAA4B,YAAY,KAAK,CAAC;IAC5E,wBAAwB,IAAI,0BAA0B;IACtD,kBAAkB,IAAI;IACtB,sBAAsB,CAAC,QAAQ,GAAG,CAAC,oBAAoB,IAAI,MAAM,MAAM;IACvE,sBAAsB,IAAI,wBAAwB;IAClD,wBAAwB,CAAC,QAAQ,GAAG,CAAC,sBAAsB,IAAI,MAAM,MAAM;IAC3E,cAAc,CAAC,QAAQ,GAAG,CAAC,YAAY,IAAI,MAAM,MAAM;AACvD","debugId":null}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/lib/logger.ts"],"sourcesContent":["export function logDebug(label: string, payload: unknown) {\r\ntry { console.log(`[TecDoc] ${label}:`, JSON.stringify(payload)) } catch {}\r\n}\r\nexport function logError(label: string, payload: unknown) {\r\ntry { console.error(`[TecDoc][ERROR] ${label}:`, JSON.stringify(payload)) } catch {}\r\n}"],"names":[],"mappings":";;;;;;AAAO,SAAS,SAAS,KAAa,EAAE,OAAgB;IACxD,IAAI;QAAE,QAAQ,GAAG,CAAC,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC;IAAU,EAAE,OAAM,CAAC;AAC1E;AACO,SAAS,SAAS,KAAa,EAAE,OAAgB;IACxD,IAAI;QAAE,QAAQ,KAAK,CAAC,CAAC,gBAAgB,EAAE,MAAM,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC;IAAU,EAAE,OAAM,CAAC;AACnF","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/lib/tecdoc.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\nimport { ENV } from \"@/lib/env\";\r\nimport { logDebug, logError } from \"@/lib/logger\";\r\n\r\nexport const TecdocOps = {\r\n  searchTerm: \"articleSearchByTerm\",\r\n  byPlate: \"getVehiclesByKeyNumberPlates\",\r\n  byVin: \"getVehiclesByVIN\",\r\n  byMotorId: \"getVehicleIdsByMotor2\",\r\n  manufacturers: \"getManufacturers\",\r\n  models: \"getModelSeries\",\r\n  types: \"getVehicleIdsByCriteria\",\r\n  genericArticles: \"getGenericArticles\",\r\n  amBrands: \"getAmBrands\",\r\n  articleById: \"getArticleDirectSearchById\",\r\n  articleImages: \"getArticleImages\",\r\n  articleIdsWithState: \"getArticleIdsWithState\",\r\n  assignedArticlesByIds6: \"getAssignedArticlesByIds6\",\r\n} as const;\r\n\r\nexport type TecdocResource =\r\n  | (typeof TecdocOps)[keyof typeof TecdocOps]\r\n  | string;\r\n\r\nexport interface TecdocResponse<T = any> {\r\n  status?: number;\r\n  statusText?: string;\r\n  data?: { array?: T[] } & Record<string, any>;\r\n  [k: string]: any;\r\n}\r\n\r\nexport async function tecdocCall<T = any>(\r\n  resource: TecdocResource,\r\n  params: Record<string, any> = {},\r\n  init?: RequestInit\r\n): Promise<TecdocResponse<T>> {\r\n  const controller = new AbortController();\r\n  const timeout = setTimeout(() => controller.abort(), 15000);\r\n\r\n  // inner payload mirrors browser client examples\r\n  const inner = {\r\n    provider: Number(ENV.TECDOC_PROVIDER_ID),\r\n    // many endpoints require these explicitly:\r\n    lang: ENV.TECDOC_LANG_DEFAULT,\r\n    country: ENV.TECDOC_LINKAGE_COUNTRY,\r\n    countryCode: ENV.TECDOC_LINKAGE_COUNTRY,\r\n    articleCountry: ENV.TECDOC_ARTICLE_COUNTRIES[0],\r\n    ...params,\r\n  };\r\n\r\n  // top-level key = functionName/resource\r\n  const body: Record<string, any> = { [resource]: inner };\r\n\r\n  if (ENV.TECDOC_DEBUG)\r\n    logDebug(\"REQUEST\", { resource, url: ENV.TECDOC_BASE_JSON, body });\r\n\r\n  try {\r\n    const url = `${ENV.TECDOC_BASE_JSON}?api_key=${encodeURIComponent(\r\n      ENV.TECDOC_API_KEY\r\n    )}`;\r\n    const res = await fetch(url, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"content-type\": \"application/json\",\r\n        \"X-Api-Key\": ENV.TECDOC_API_KEY,\r\n      },\r\n      body: JSON.stringify(body),\r\n      signal: controller.signal,\r\n      ...init,\r\n    });\r\n\r\n    clearTimeout(timeout);\r\n\r\n    const text = await res.text();\r\n    let json: TecdocResponse<T>;\r\n    try {\r\n      json = JSON.parse(text);\r\n    } catch {\r\n      json = { raw: text } as any;\r\n    }\r\n\r\n    if (!res.ok) {\r\n      logError(\"RESPONSE\", {\r\n        status: res.status,\r\n        statusText: res.statusText,\r\n        raw: text.slice(0, 500),\r\n      });\r\n      throw new TecdocHttpError(\r\n        String(resource),\r\n        res.status,\r\n        res.statusText,\r\n        text\r\n      );\r\n    }\r\n\r\n    if (ENV.TECDOC_DEBUG)\r\n      logDebug(\"RESPONSE\", {\r\n        resource,\r\n        status: json?.status,\r\n        statusText: json?.statusText,\r\n        dataLen: json?.data?.array?.length,\r\n      });\r\n\r\n    return json;\r\n  } catch (err: any) {\r\n    if (err?.name === \"AbortError\") {\r\n      logError(\"TIMEOUT\", { resource });\r\n      throw new TecdocHttpError(\r\n        String(resource),\r\n        504,\r\n        \"Timeout\",\r\n        \"Request timed out\"\r\n      );\r\n    }\r\n    logError(\"FETCH_ERROR\", { resource, message: String(err?.message || err) });\r\n    throw err;\r\n  }\r\n}\r\n\r\nexport class TecdocHttpError extends Error {\r\n  constructor(\r\n    public resource: string,\r\n    public status: number,\r\n    public statusText: string,\r\n    public rawBody?: string\r\n  ) {\r\n    super(`TecDoc ${resource} ${status}: ${statusText}`);\r\n  }\r\n}\r\n\r\nexport function qp(req: Request, key: string, dflt?: string) {\r\n  const url = new URL(req.url);\r\n  return (url.searchParams.get(key) ?? dflt)?.trim();\r\n}\r\nexport function qpn(req: Request, key: string, dflt?: number) {\r\n  const v = qp(req, key);\r\n  if (!v) return dflt;\r\n  const n = Number(v);\r\n  return Number.isFinite(n) ? n : dflt;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/enesk/Documents/oemonline-next15-shadcn/app/api/vehicle-details/route.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\r\n// app/api/vehicle-details/route.ts\r\nimport { NextResponse } from \"next/server\"\r\nimport { tecdocCall, qp, qpn } from \"@/lib/tecdoc\"\r\nimport { ENV } from \"@/lib/env\"\r\nimport { logDebug, logError } from \"@/lib/logger\"\r\n\r\nexport const dynamic = \"force-dynamic\"\r\n\r\ntype NormalizedVehicle = {\r\n  manuId?: number\r\n  manuName?: string\r\n  modelSeriesId?: number\r\n  modelSeriesName?: string\r\n  typeId?: number // == carId / kType\r\n  typeName?: string\r\n}\r\n\r\nfunction normalizeVehicleShape(raw: any): NormalizedVehicle {\r\n  const v = raw?.data?.array?.[0] ?? raw?.data ?? raw ?? {}\r\n  const n: NormalizedVehicle = {\r\n    manuId:\r\n      v.manuId ??\r\n      v.manufacturerId ??\r\n      v.manuNo ??\r\n      v?.manufacturer?.id,\r\n    manuName:\r\n      v.manuName ??\r\n      v.manufacturerName ??\r\n      v?.manufacturer?.name,\r\n    modelSeriesId:\r\n      v.modelSeriesId ??\r\n      v.modId ??\r\n      v?.modelSeries?.id,\r\n    modelSeriesName:\r\n      v.modelSeriesName ??\r\n      v.modelName ??\r\n      v?.modelSeries?.name,\r\n    typeId:\r\n      v.typeId ??\r\n      v.carId ??\r\n      v.kType ??\r\n      v.vehicleId ??\r\n      v?.vehicle?.id,\r\n    typeName:\r\n      v.typeName ??\r\n      v.carName ??\r\n      v.vehicleName ??\r\n      v?.vehicle?.name,\r\n  }\r\n  return n\r\n}\r\n\r\nexport async function GET(req: Request) {\r\n  const carId = qpn(req, \"carId\")\r\n  const country = qp(req, \"country\", ENV.TECDOC_LINKAGE_COUNTRY)\r\n  const lang = qp(req, \"lang\", ENV.TECDOC_LANG_DEFAULT)\r\n\r\n  if (!carId) return NextResponse.json({ error: \"Missing carId\" }, { status: 400 })\r\n\r\n  try {\r\n    // 1) Meest informatief in veel tenants\r\n    logDebug(\"VEHICLE_DETAILS_TRY_1\", { carId })\r\n    const r1 = await tecdocCall(\"getVehicleByIds4\", {\r\n      country,\r\n      lang,\r\n      vehicleIds: { array: [carId] },\r\n      linkingTargetId: carId,\r\n      linkingTargetType: \"P\",\r\n    })\r\n    const norm1 = normalizeVehicleShape(r1)\r\n    if (norm1?.typeId) {\r\n      return NextResponse.json({ ok: true, source: \"getVehicleByIds4\", normalized: norm1, raw: r1 }, {\r\n        headers: { \"Cache-Control\": \"private, max-age=300\" },\r\n      })\r\n    }\r\n  } catch (e) {\r\n    logError(\"VEHICLE_DETAILS_TRY_1_FAIL\", { message: String((e as Error).message) })\r\n  }\r\n\r\n  try {\r\n    // 2) Fallback\r\n    logDebug(\"VEHICLE_DETAILS_TRY_2\", { carId })\r\n    const r2 = await tecdocCall(\"getLinkageTargets\", {\r\n      country,\r\n      lang,\r\n      linkingTargetId: carId,\r\n      linkingTargetType: \"P\",\r\n      includeLinkedData: true,\r\n      includeDetails: true,\r\n    })\r\n    const norm2 = normalizeVehicleShape(r2)\r\n    return NextResponse.json({ ok: true, source: \"getLinkageTargets\", normalized: norm2, raw: r2 }, {\r\n      headers: { \"Cache-Control\": \"private, max-age=300\" },\r\n    })\r\n  } catch (e) {\r\n    logError(\"VEHICLE_DETAILS_TRY_2_FAIL\", { message: String((e as Error).message) })\r\n    return NextResponse.json({ error: \"Kon voertuigdetails niet ophalen\" }, { status: 502 })\r\n  }\r\n}\r\n"],"names":[],"mappings":"AAAA,qDAAqD,GACrD,mCAAmC;;;;;;;AACnC;AACA;AACA;AACA;;;;;AAEO,MAAM,UAAU;AAWvB,SAAS,sBAAsB,GAAQ;IACrC,MAAM,IAAI,KAAK,MAAM,OAAO,CAAC,EAAE,IAAI,KAAK,QAAQ,OAAO,CAAC;IACxD,MAAM,IAAuB;QAC3B,QACE,EAAE,MAAM,IACR,EAAE,cAAc,IAChB,EAAE,MAAM,IACR,GAAG,cAAc;QACnB,UACE,EAAE,QAAQ,IACV,EAAE,gBAAgB,IAClB,GAAG,cAAc;QACnB,eACE,EAAE,aAAa,IACf,EAAE,KAAK,IACP,GAAG,aAAa;QAClB,iBACE,EAAE,eAAe,IACjB,EAAE,SAAS,IACX,GAAG,aAAa;QAClB,QACE,EAAE,MAAM,IACR,EAAE,KAAK,IACP,EAAE,KAAK,IACP,EAAE,SAAS,IACX,GAAG,SAAS;QACd,UACE,EAAE,QAAQ,IACV,EAAE,OAAO,IACT,EAAE,WAAW,IACb,GAAG,SAAS;IAChB;IACA,OAAO;AACT;AAEO,eAAe,IAAI,GAAY;IACpC,MAAM,QAAQ,IAAA,oKAAG,EAAC,KAAK;IACvB,MAAM,UAAU,IAAA,mKAAE,EAAC,KAAK,WAAW,iKAAG,CAAC,sBAAsB;IAC7D,MAAM,OAAO,IAAA,mKAAE,EAAC,KAAK,QAAQ,iKAAG,CAAC,mBAAmB;IAEpD,IAAI,CAAC,OAAO,OAAO,6TAAY,CAAC,IAAI,CAAC;QAAE,OAAO;IAAgB,GAAG;QAAE,QAAQ;IAAI;IAE/E,IAAI;QACF,uCAAuC;QACvC,IAAA,yKAAQ,EAAC,yBAAyB;YAAE;QAAM;QAC1C,MAAM,KAAK,MAAM,IAAA,2KAAU,EAAC,oBAAoB;YAC9C;YACA;YACA,YAAY;gBAAE,OAAO;oBAAC;iBAAM;YAAC;YAC7B,iBAAiB;YACjB,mBAAmB;QACrB;QACA,MAAM,QAAQ,sBAAsB;QACpC,IAAI,OAAO,QAAQ;YACjB,OAAO,6TAAY,CAAC,IAAI,CAAC;gBAAE,IAAI;gBAAM,QAAQ;gBAAoB,YAAY;gBAAO,KAAK;YAAG,GAAG;gBAC7F,SAAS;oBAAE,iBAAiB;gBAAuB;YACrD;QACF;IACF,EAAE,OAAO,GAAG;QACV,IAAA,yKAAQ,EAAC,8BAA8B;YAAE,SAAS,OAAO,AAAC,EAAY,OAAO;QAAE;IACjF;IAEA,IAAI;QACF,cAAc;QACd,IAAA,yKAAQ,EAAC,yBAAyB;YAAE;QAAM;QAC1C,MAAM,KAAK,MAAM,IAAA,2KAAU,EAAC,qBAAqB;YAC/C;YACA;YACA,iBAAiB;YACjB,mBAAmB;YACnB,mBAAmB;YACnB,gBAAgB;QAClB;QACA,MAAM,QAAQ,sBAAsB;QACpC,OAAO,6TAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,QAAQ;YAAqB,YAAY;YAAO,KAAK;QAAG,GAAG;YAC9F,SAAS;gBAAE,iBAAiB;YAAuB;QACrD;IACF,EAAE,OAAO,GAAG;QACV,IAAA,yKAAQ,EAAC,8BAA8B;YAAE,SAAS,OAAO,AAAC,EAAY,OAAO;QAAE;QAC/E,OAAO,6TAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmC,GAAG;YAAE,QAAQ;QAAI;IACxF;AACF","debugId":null}}]
}